<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Administrador de Barbería</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    .section { display: none; }
    .card p { margin: 0.2rem 0; }
  </style>
</head>

<body>
  <header class="bg-dark text-white text-center py-3">
    <div class="container">
      <img src="{{ url_for('static', filename='imges/ChatGPT Image 21 abr 2025, 01_57_49 a.m..png') }}" 
           alt="Imagen Barbería" class="img-fluid mb-2" style="max-height: 200px;">
      <h1>Panel del Administrador</h1>
    </div>
  </header>

  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="#">Barbería</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav me-auto">
          <li class="nav-item"><a class="nav-link" href="#" onclick="mostrarSeccion('citas')">Citas</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="mostrarSeccion('barberos')">Barberos</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="mostrarSeccion('productos')">Productos</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="mostrarSeccion('reportes')">Reportes</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container my-4">

    <!-- Citas -->
    <div class="section" id="citas">
      <h2>Citas</h2>
      <div class="row mb-4">
        <div class="col-md-4">
          <input type="text" class="form-control" id="filtroBarbero" placeholder="Filtrar por barbero" />
        </div>
        <div class="col-md-4">
          <input type="time" class="form-control" id="filtroHora" />
        </div>
        <div class="col-md-4">
          <input type="date" class="form-control" id="filtroFecha" />
        </div>
      </div>
      <div class="row" id="contenedorCitas">
        {% for cita in citas %}
        <div class="col-md-4 cita-card" 
             data-barbero="{{ cita.barbero }}" 
             data-hora="{{ cita.hora }}" 
             data-fecha="{{ cita.fecha }}">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Cliente: {{ cita.cliente }}</h5>
              <p>Fecha: {{ cita.fecha }}</p>
              <p>Hora: {{ cita.hora }}</p>
              <p>Barbero: {{ cita.barbero }}</p>
              <p>Servicio: {{ cita.servicio }}</p>
              <p class="{% if cita.estado == 'Pendiente' %}text-warning{% elif cita.estado == 'Completada' %}text-success{% else %}text-danger{% endif %}">
                Estado: {{ cita.estado }}
              </p>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>

    <!-- Barberos -->
    <div class="section" id="barberos">
      <h2>Barberos</h2>
      <!-- Botón para abrir el modal -->
        <div class="mb-3">
          <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalAgregarBarbero">
            Agregar Barbero
          </button>
        </div>
      <div class="row">
        {% for barbero in barberos %}
        <div class="col-md-4">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">{{ barbero.nombre }}</h5>
              <p>Calificación: {{ barbero.calificacion }}</p>
              <p>Teléfono: {{ barbero.telefono }}</p>
              <p class="{% if barbero.estado == 'Disponible' %}text-success{% elif barbero.estado == 'Ocupado' %}text-warning{% else %}text-danger{% endif %}">
                Estado: {{ barbero.estado }}
              </p>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>

      <!-- Modal para agregar barbero -->
  <div class="modal fade" id="modalAgregarBarbero" tabindex="-1" aria-labelledby="modalAgregarBarberoLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form method="POST" action="{{ url_for('agregar_barbero') }}" enctype="multipart/form-data">
          <div class="modal-header">
            <h5 class="modal-title" id="modalAgregarBarberoLabel">Nuevo Barbero</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="nombreBarbero" class="form-label">Nombre</label>
              <input type="text" class="form-control" id="nombreBarbero" name="nombre" required>
            </div>
            <div class="mb-3">
              <label for="telefonoBarbero" class="form-label">Teléfono</label>
              <input type="tel" class="form-control" id="telefonoBarbero" name="telefono" required>
            </div>
            <div class="mb-3">
              <label for="imagenBarbero" class="form-label">Imagen</label>
              <input type="file" class="form-control" id="imagenBarbero" name="imagen" accept="image/*" required>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="submit" class="btn btn-primary">Guardar</button>
          </div>
        </form>
      </div>
    </div>
  </div>


    <!-- Productos -->
    <div class="section" id="productos">
      <h2>Productos</h2>
      <div class="row">
        {% for producto in productos %}
        <div class="col-md-4">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">{{ producto.nombre }}</h5>
              <p>Categoría: {{ producto.categoria }}</p>
              <p>Stock: {{ producto.stock }}</p>
              <p>Precio: ${{ producto.precio }}</p>
              <p class="{% if producto.estado == 'Disponible' %}text-success{% elif producto.estado == 'Agotado' %}text-danger{% else %}text-warning{% endif %}">
                Estado: {{ producto.estado }}
              </p>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>

    <!-- Reportes -->
    <div class="section" id="reportes">
      <h2>Reportes del Día</h2>
      <ul class="list-group">
        {% for r in reportes %}
        <li class="list-group-item">Cita: {{ r.cliente }} - {{ r.servicio }} - {{ r.hora }}</li>
        {% endfor %}
      </ul>
      <h4 class="mt-3">Ganancias totales: ${{ total_ganancias }}</h4>
    </div>
  </div>

  <script>
    function mostrarSeccion(id) {
      const secciones = document.querySelectorAll('.section');
      secciones.forEach(seccion => seccion.style.display = 'none');
      document.getElementById(id).style.display = 'block';
    }

    const filtroBarbero = document.getElementById('filtroBarbero');
    const filtroHora = document.getElementById('filtroHora');
    const filtroFecha = document.getElementById('filtroFecha');

    function filtrarCitas() {
      const barbero = filtroBarbero.value.toLowerCase();
      const hora = filtroHora.value;
      const fecha = filtroFecha.value;

      const cartas = document.querySelectorAll('.cita-card');

      cartas.forEach(carta => {
        const barberoCarta = carta.getAttribute('data-barbero').toLowerCase();
        const horaCarta = carta.getAttribute('data-hora');
        const fechaCarta = carta.getAttribute('data-fecha');

        const cumpleBarbero = !barbero || barberoCarta.includes(barbero);
        const cumpleHora = !hora || horaCarta === hora;
        const cumpleFecha = !fecha || fechaCarta === fecha;

        carta.style.display = (cumpleBarbero && cumpleHora && cumpleFecha) ? 'block' : 'none';
      });
    }

    filtroBarbero.addEventListener('input', filtrarCitas);
    filtroHora.addEventListener('change', filtrarCitas);
    filtroFecha.addEventListener('change', filtrarCitas);
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>